<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Pagina Inicial</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
    <link rel="stylesheet" href="./contratos.css"/>


</head>

<body>
<div class="index">
    <div class="sidebar">

        <nav>
            <a href="/paginaInicial">
                <button class="botao-sidebar" href="produtor.html">
	              <span>
	                <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              height="24px"
                              stroke-width="1.5"
                              viewBox="0 0 24 24"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
	                  <path
                              d="M3 5H21"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M3 12H21"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M3 19H21"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                </svg>
	                <span>Home</span>
	              </span>
                </button>
            </a>
            <a href="/propriedade">
                <button class="botao-sidebar">
	              <span>
	                <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              height="24px"
                              viewBox="0 0 24 24"
                              stroke-width="1.5"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
	                  <path
                              d="M2 8L11.7317 3.13416C11.9006 3.04971 12.0994 3.0497 12.2683 3.13416L22 8"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M20 11V19C20 20.1046 19.1046 21 18 21H6C4.89543 21 4 20.1046 4 19V11"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                </svg>
	                <span>Propriedades</span>
	              </span>
                </button>
            </a>
            <a href="/cursos">
                <button class="botao-sidebar">
	              <span>
	                <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              stroke-width="1.5"
                              height="24px"
                              viewBox="0 0 24 24"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
	                  <path
                              d="M4 19V5C4 3.89543 4.89543 3 6 3H19.4C19.7314 3 20 3.26863 20 3.6V16.7143"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 17L20 17"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 21L20 21"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 21C4.89543 21 4 20.1046 4 19C4 17.8954 4.89543 17 6 17"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M9 7L15 7"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                </svg>
	                <span>Cursos</span>
	              </span>
                </button>
            </a>
            <a href="/contratos">
                <button class="botao-sidebar">
	              <span>
	                <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              stroke-width="1.5"
                              height="24px"
                              viewBox="0 0 24 24"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
	                  <path
                              d="M4 19V5C4 3.89543 4.89543 3 6 3H19.4C19.7314 3 20 3.26863 20 3.6V16.7143"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 17L20 17"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 21L20 21"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                  <path
                              d="M6 21C4.89543 21 4 20.1046 4 19C4 17.8954 4.89543 17 6 17"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M9 7L15 7"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                      ></path>
	                </svg>
	                <span>Contratos</span>
	              </span>
                </button>
            </a>
            <a href="/fornecedores">
                <button class="botao-sidebar" href="produtor.html">
	              <span>
	                <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              height="24px"
                              stroke-width="1.5"
                              viewBox="0 0 24 24"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
	                  <path
                              d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M4.271 18.3457C4.271 18.3457 6.50002 15.5 12 15.5C17.5 15.5 19.7291 18.3457 19.7291 18.3457"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                  <path
                              d="M12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12Z"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
	                </svg>
	                <span>Fornecedores</span>
	              </span>
                </button>
            </a>
            <a href="/usuarios">
                <button class="botao-sidebar" href="produtor.html">
                  <span>
                    <?xml version="1.0" encoding="UTF-8"?>
                      <svg
                              width="24px"
                              height="24px"
                              stroke-width="1.5"
                              viewBox="0 0 24 24"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                              color="#000000"
                      >
                      <path
                              d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
                      <path
                              d="M4.271 18.3457C4.271 18.3457 6.50002 15.5 12 15.5C17.5 15.5 19.7291 18.3457 19.7291 18.3457"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
                      <path
                              d="M12 12C13.6569 12 15 10.6569 15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9C9 10.6569 10.3431 12 12 12Z"
                              stroke="#000000"
                              stroke-width="1.5"
                              stroke-linecap="round"
                              stroke-linejoin="round"
                      ></path>
                    </svg>
                    <span>Usuarios</span>
                  </span>
                </button>
            </a>
        </nav>
    </div>
    <div class="w-100">
        <div th:insert="~{fragments/header :: header}"></div>

        <div style="height:90vh">
            <div class=" d-flex justify-content-center align-items-center" style="height: 60%; margin-right: 100px;">
                <div class=" w-50 d-flex flex-column justify-content-center align-items-center m-3 rounded shadow"
                     style="height:80%; ">
                    <p style="font-size: 20px;">Quantidade de propriedades por status</p>
                    <div id="chart" class="" style="height:75%; width:80%"></div>
                </div>

                <div class=" w-50 m-3" style="height:80%;">
                    <div class="p-2 rounded shadow" style="width: 100%; height: 100%">
                        <iframe id="mapaIframe" class="rounded" width="100%" height="100%" frameborder="0"
                                scrolling="no"
                                marginheight="0"
                                marginwidth="0"
                                src="https://maps.google.com/maps?width=100%25&amp;height=100%25&amp;hl=en&amp;q=toledo&amp;t=&amp;z=14&amp;ie=UTF8&amp;iwloc=B&amp;output=embed">
                        </iframe>
                    </div>
                </div>
            </div>
            <div class=" d-flex justify-content-center align-items-center" style="height: 40%; margin-right: 100px;">
                <div class=" w-50 d-flex flex-column justify-content-center align-items-center m-3 rounded shadow"
                     style="height:100%; ">
                    <p style="font-size: 20px;">Top 5 tecnologias mais produzidas</p>
                    <div id="chart2" class="" style="height:75%; width:100%"></div>
                </div>
                <div class=" w-50 d-flex justify-content-center align-items-center m-3 rounded shadow"
                     style="height:100%; ">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>Ultimas propriedades cadastradas</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="propriedade : ${propriedades}">

                            <td th:text="${propriedade.nomePropriedade}"></td>
                            <td class="d-flex justify-content-end">
                                <button
                                        class="btn btn-primary"
                                        th:attr="onclick=|verMapa(${propriedade.latitude}, ${propriedade.longitude})|"
                                >
                                    Ver no mapa
                                </button>
                            </td>

                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>


        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script type="text/javascript" charset="utf8"
                src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
        <script th:inline="javascript">
            var options = {
                series: [
                    [[${type1Count}]],
                    [[${type2Count}]],
                    [[${type3Count}]]
                ],
                chart: {
                    type: 'donut',
                },
                colors: ['#32CD32', '#e2c31d', '#FF0000'],
                labels: ['Ativo', 'Ativos em contemplação', 'Desistentes'],
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 500
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };

            var chart = new ApexCharts(document.querySelector("#chart"), options);
            chart.render();

            // Converta o modelo 'topTec' para um array JavaScript
            var topTec = /*[[${topTec}]]*/ [];

            var categories = topTec.map(function (item) {
                return item.nome;
            });
            var values = topTec.map(function (item) {
                return item.qtd;
            });

            var options = {
                series: [{
                    data: values
                }],
                chart: {
                    height: 250,
                    type: 'bar',
                    events: {
                        click: function (chart, w, e) {
                            // console.log(chart, w, e)
                        }
                    }
                },
                colors: ['#546E7A', '#FF9800', '#141f29'],
                plotOptions: {
                    bar: {
                        columnWidth: '45%',
                        distributed: true,
                    }
                },
                dataLabels: {
                    enabled: false
                },
                legend: {
                    show: false
                },
                xaxis: {
                    categories: categories,
                    labels: {
                        style: {
                            colors: ['#546E7A', '#FF9800', '#141f29'],
                            fontSize: '12px'
                        }
                    }
                }
            };

            var chart = new ApexCharts(document.querySelector("#chart2"), options);
            chart.render();
        </script>
        <script>
            function verMapa(latitude, longitude) {
                console.log(latitude)
                var iframe = document.getElementById("mapaIframe");
                var url = `https://maps.google.com/maps?width=100%&height=300&hl=en&q=${latitude},${longitude}&t=&z=13&ie=UTF8&iwloc=B&output=embed`;
                iframe.src = url;
            }
        </script>
</body>
</html>
